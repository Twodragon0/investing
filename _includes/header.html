<header class="site-header">
  <div class="container">
    <a href="{{ '/' | relative_url }}" class="site-logo">ğŸ‰ {{ site.title }}</a>
    <nav class="site-nav">
      {% for item in site.data.navigation.main %}
        {% if item.children %}
          <div class="nav-dropdown">
            <button class="nav-dropdown-btn" type="button">
              {{ item.title }}
              <svg width="10" height="10" viewBox="0 0 10 10" fill="currentColor" aria-hidden="true"><path d="M2 4l3 3 3-3"/></svg>
            </button>
            <div class="nav-dropdown-menu">
              {% for child in item.children %}
                <a href="{{ child.url | relative_url }}" {% if page.url == child.url %}class="active"{% endif %}>{{ child.title }}</a>
              {% endfor %}
            </div>
          </div>
        {% else %}
          <a href="{{ item.url | relative_url }}" class="nav-link" {% if page.url == item.url %}class="active"{% endif %}>{{ item.title }}</a>
        {% endif %}
      {% endfor %}
    </nav>
    <div class="nav-actions">
      <div class="search-toggle-wrapper">
        <button class="search-toggle" aria-label="ê²€ìƒ‰" type="button">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
          </svg>
        </button>
      </div>
      <div class="lang-toggle-wrapper notranslate" translate="no">
        <button class="lang-toggle" id="lang-toggle" aria-label="ì–¸ì–´ ë³€ê²½" aria-expanded="false" aria-controls="lang-dropdown" type="button">
          <svg class="globe-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
          </svg>
          <span class="lang-code notranslate" id="current-lang" translate="no">KO</span>
        </button>
        <div class="lang-dropdown-overlay" id="lang-dropdown-overlay" aria-hidden="true"></div>
        <div class="lang-dropdown notranslate" id="lang-dropdown" translate="no" role="menu" aria-label="ì–¸ì–´ ì„ íƒ">
          <button class="lang-option" data-lang="ko" title="í•œêµ­ì–´" role="menuitem"><span class="lang-flag">ğŸ‡°ğŸ‡·</span><span class="lang-name">í•œêµ­ì–´</span></button>
          <button class="lang-option" data-lang="en" title="English" role="menuitem"><span class="lang-flag">ğŸ‡ºğŸ‡¸</span><span class="lang-name">English</span></button>
          <button class="lang-option" data-lang="ja" title="æ—¥æœ¬èª" role="menuitem"><span class="lang-flag">ğŸ‡¯ğŸ‡µ</span><span class="lang-name">æ—¥æœ¬èª</span></button>
          <button class="lang-option" data-lang="zh-CN" title="ç®€ä½“ä¸­æ–‡" role="menuitem"><span class="lang-flag">ğŸ‡¨ğŸ‡³</span><span class="lang-name">ç®€ä½“ä¸­æ–‡</span></button>
          <button class="lang-option" data-lang="zh-TW" title="ç¹é«”ä¸­æ–‡" role="menuitem"><span class="lang-flag">ğŸ‡¹ğŸ‡¼</span><span class="lang-name">ç¹é«”ä¸­æ–‡</span></button>
        </div>
        <div id="google_translate_element" style="display:none;"></div>
        {% include google-translate.html %}
      </div>
    </div>
    <button class="nav-toggle" aria-label="Toggle navigation">â˜°</button>
  </div>
</header>

<!-- Search Overlay -->
<div class="search-overlay" id="search-overlay">
  <div class="search-overlay-content">
    <div class="search-overlay-header">
      <input type="text" id="search-input" class="search-overlay-input" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." autocomplete="off" data-baseurl="{{ site.baseurl }}">
      <button class="search-overlay-close" aria-label="ë‹«ê¸°">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
    <div id="search-results" class="search-results"></div>
  </div>
</div>

<script>
// Mobile nav toggle
document.querySelector('.nav-toggle').addEventListener('click', function() {
  document.querySelector('.site-nav').classList.toggle('active');
});

// Mobile dropdown toggles
document.querySelectorAll('.nav-dropdown-btn').forEach(function(btn) {
  btn.addEventListener('click', function(e) {
    if (window.innerWidth <= 768) {
      e.preventDefault();
      e.stopPropagation();
      this.closest('.nav-dropdown').classList.toggle('open');
    }
  });
});

// Close dropdowns on outside click
document.addEventListener('click', function(e) {
  if (!e.target.closest('.nav-dropdown')) {
    document.querySelectorAll('.nav-dropdown.open').forEach(function(d) { d.classList.remove('open'); });
  }
});

// Search overlay toggle
var searchToggle = document.querySelector('.search-toggle');
var searchOverlay = document.getElementById('search-overlay');
var searchClose = document.querySelector('.search-overlay-close');
var searchInput = document.getElementById('search-input');

if (searchToggle && searchOverlay) {
  searchToggle.addEventListener('click', function() {
    searchOverlay.classList.add('active');
    setTimeout(function() { searchInput.focus(); }, 100);
  });

  searchClose.addEventListener('click', function() {
    searchOverlay.classList.remove('active');
    searchInput.value = '';
    document.getElementById('search-results').innerHTML = '';
  });

  searchOverlay.addEventListener('click', function(e) {
    if (e.target === searchOverlay) {
      searchOverlay.classList.remove('active');
      searchInput.value = '';
      document.getElementById('search-results').innerHTML = '';
    }
  });

  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && searchOverlay.classList.contains('active')) {
      searchOverlay.classList.remove('active');
      searchInput.value = '';
      document.getElementById('search-results').innerHTML = '';
    }
  });
}
</script>
